# fusion-collector

fusion project 的静态分析器, 用来提取 next 组件的使用情况

## 使用方法: 

```js
import { collectDetail, collectBrief } from '@alifd/fusion-collector';
collectDetail({
    rootDir: process.cwd(), // 项目根地址
    basicPackage: '@alifd/next', // 主体包名称
    kit: 'fie-toolkit-next' // 统计的来源
});

const projectId = 'iceWorks';
// collectBrief(pid, 'a.b', args)
// projectId 区分项目 
// key值用 . 区分用以统计展示
// args自定义参数 要求字符串
collectBrief(projectId, 'operator.init', JSON.stringify({scaffold: 'design-pro'}));
collectBrief(projectId, 'operator.start');
collectBrief(projectId, 'operator.debug');
```

## 测试

```bash
tnpm  i -g @alifd/fusion-collector

DEBUG=next:collect tnpm run compile-test
```

## 收集信息:

- package.json
- 已安装的模块版本信息
- src 下每个 js/jsx 文件的 import / require 的模块
- 对引入的 next 基本组件/业务组件/第三方模块 使用情况的分析

## 对象结构: 

```js
// 返回结构
{
    collectBrief,
    collectDetail
};

// 提交结构
// collectBrief
macAddress()+ '__' + projectId + '__' + key

// collectDetail
{
    "author": "游鹿", // 项目作者
    "repoName": "@alifd/fusion-collector", // 仓库名
    "gitUrl": "",
    "kit": "fie-toolkit-next",
    "basicPackage": "@alifd/next", // 主体包名称 
    "basicPackageVersion": "2.0.16"// 主体包版本
    "basicComponentsTimes": "{}"// 主体包版本
    "pkg": {
        "name": "",
        "description": "",
        "dependencies": ""
        // ... 这是 package.json 的内容
    }
}
```

